"use strict";(self.webpackChunkfront_financas=self.webpackChunkfront_financas||[]).push([[277],{2277:(w,p,t)=>{t.r(p),t.d(p,{FornecedorListaModule:()=>I});var h=t(6895),m=t(433),n=t(8654),u=t(790);const f=[{property:"nome",label:"Fornecedor"},{property:"ativo",label:"Status",type:"cellTemplate"}];var l=t(6364),e=t(4650),d=t(4229),F=t(1481),g=t(3671);const v=["tabelaListaFornecedor"],b=["paginaListaFornecedor"];function L(s,c){1&s&&(e.TgZ(0,"span",9),e._uU(1,"ATIVO"),e.qZA())}function D(s,c){1&s&&(e.TgZ(0,"span",10),e._uU(1,"INATIVO"),e.qZA())}function T(s,c){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,L,2,0,"span",7),e.YNc(2,D,2,0,"span",8),e.qZA()),2&s){const o=e.oxw().row;e.xp6(1),e.Q6J("ngIf",1==o.ativo),e.xp6(1),e.Q6J("ngIf",0==o.ativo)}}function C(s,c){1&s&&e.YNc(0,T,3,2,"div",6),2&s&&e.Q6J("ngIf","ativo"===c.column.property)}const A=[{path:"",component:(()=>{class s{constructor(o,r,i,a,M){this.router=o,this.titleService=r,this.poNotification=i,this.fornecedorApiService=a,this.poDialog=M,this.nomePagina=l.fP.label,this.colunasTabelaFornecedor=f,this.disclaimers=new Array,this.carregandoTabelaFornecedor=!1,this.carregandoDadosFornecedor=!1,this.desabilitarCarregarMais=!1,this.acoes=[{label:`Novo ${this.nomePagina}`,action:this.novaFornecedor.bind(this),icon:"po-icon-plus"}],this.paginacao={page:0},this.fornecedorListaFilter={action:this.buscar.bind(this),placeholder:"Pesquisar C\xf3digo ou Descri\xe7\xe3o",width:4},this.fornecedorListaDisclaimer={title:"Filtros",disclaimers:[],remove:this.removerDisclaimer.bind(this),removeAll:this.removerTodosDisclaimer.bind(this)},this.fornecedorListaAcoes=(0,u.L)(this.editarFornecedor.bind(this),this.removerFornecedorDialog.bind(this))}ngOnInit(){this.buscarNovosDados(this.filtroFornecedor)}ngAfterViewInit(){this.titleService.setTitle(`${this.nomePagina}`)}novaFornecedor(){this.router.navigate([l.q3.link])}buscar(o){this.carregandoTabelaFornecedor=!0,this.filtroLista=o,this.limparItensFornecedors(),this.popularDisclaimers(this.filtroFornecedor,this.filtroLista),this.buscarNovosDados(this.filtroFornecedor),this.carregandoTabelaFornecedor=!1}buscarNovosDados(o){this.limparItensFornecedors(),this.buscarMaisDados(o)}buscarMaisDados(o){this.filtroFornecedor=o,this.popularDisclaimers(this.filtroFornecedor,this.filtroLista);const r=this.criarParametroFornecedor(this.filtroFornecedor,this.filtroLista);this.carregandoTabelaFornecedor=!0,this.fornecedorApiService.buscarFornecedors(r,this.paginacao.page).subscribe({next:i=>{this.tabelaListaFornecedor.sortColumn({}),this.listaFornecedors=this.listaFornecedors?[...this.listaFornecedors,...i.content]:[...i.content],this.desabilitarCarregarMais=i.last},error:({error:i})=>{this.limparItensFornecedors(),this.poNotification.error(i?.title?i.title:"Erro no servidor"),console.error(i)},complete:()=>{this.carregandoTabelaFornecedor=!1}})}popularDisclaimers(o,r){this.disclaimers=[],r&&this.disclaimers.push(this.processaFiltroLista(r)),o&&this.disclaimers.push(...this.processaFiltroFornecedorAvancado(o)),this.fornecedorListaDisclaimer.disclaimers=this.disclaimers&&this.disclaimers.length>0?[...this.disclaimers]:[]}processaFiltroLista(o){return{label:"Pesquisar: "+o,value:o,property:"filtroLista"}}processaFiltroFornecedorAvancado(o){return Object.entries(o).filter(r=>Array.isArray(r[1]?.value)?!!r[1].value.length:r[1]?.value).map(r=>({label:r[1].fLabel(r[1]),value:r,property:r[1].property,hideClose:r[1].hideClose}))}criarParametroFornecedor(o,r){if(o||r)return{nome:o?.nome?.value,pesquisar:r}}limparItensFornecedors(){this.paginacao.page=0,this.listaFornecedors=[],this.desabilitarCarregarMais=!0}removerDisclaimer(o){"filtroLista"===o.removedDisclaimer.property&&(this.paginaListaFornecedor.clearInputSearch(),this.buscar(""))}removerTodosDisclaimer(o){this.paginaListaFornecedor.clearInputSearch(),this.buscar("")}editarFornecedor(o){this.router.navigate([(0,l.M7)(o.id).link])}removerFornecedorDialog(o){this.poDialog.confirm({title:"Aten\xe7\xe3o",message:`Tem certeza que deseja remover a fornecedor?\n      <br>\n      <br> <b>C\xf3digo</b>: ${o.nome||""}`,confirm:()=>this.removerFornecedor(o)})}removerFornecedor(o){this.carregandoTabelaFornecedor=!0,this.fornecedorApiService.deletarFornecedor(o.id).subscribe({next:()=>{this.buscarNovosDados(this.filtroFornecedor),this.poNotification.success("Removido com sucesso")},error:({error:r})=>{this.poNotification.error(r?.detail?r.detail:"Erro no servidor"),console.error(r)},complete:()=>{this.carregandoTabelaFornecedor=!1}})}mostrarMaisFornecedors(){this.tabelaListaFornecedor.sortColumn({}),this.carregandoDadosFornecedor=!0,this.paginacao.page++,this.buscarMaisDados(this.filtroFornecedor),this.carregandoDadosFornecedor=!1}static#e=this.\u0275fac=function(r){return new(r||s)(e.Y36(d.F0),e.Y36(F.Dx),e.Y36(n.fRI),e.Y36(g.M),e.Y36(n.Aw7))};static#o=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-fornecedor-lista"]],viewQuery:function(r,i){if(1&r&&(e.Gf(v,7),e.Gf(b,7)),2&r){let a;e.iGM(a=e.CRH())&&(i.tabelaListaFornecedor=a.first),e.iGM(a=e.CRH())&&(i.paginaListaFornecedor=a.first)}},inputs:{listaFornecedors:"listaFornecedors"},decls:6,vars:13,consts:[[3,"p-actions","p-title","p-filter","p-disclaimer-group"],["paginaListaFornecedor",""],[2,"width","100%"],[2,"width","100%",3,"p-actions","p-sort","p-striped","p-loading","p-loading-show-more","p-show-more-disabled","p-items","p-columns","p-actions-right","p-show-more"],["tabelaListaFornecedor",""],["p-table-cell-template",""],[4,"ngIf"],["class","po-color-10 po-table-column-label",4,"ngIf"],["class","po-color-07 po-table-column-label",4,"ngIf"],[1,"po-color-10","po-table-column-label"],[1,"po-color-07","po-table-column-label"]],template:function(r,i){1&r&&(e.TgZ(0,"po-page-list",0,1)(2,"po-container",2)(3,"po-table",3,4),e.NdJ("p-show-more",function(){return i.mostrarMaisFornecedors()}),e.YNc(5,C,1,1,"ng-template",5),e.qZA()()()),2&r&&(e.Q6J("p-actions",i.acoes)("p-title",i.nomePagina)("p-filter",i.fornecedorListaFilter)("p-disclaimer-group",i.fornecedorListaDisclaimer),e.xp6(3),e.Q6J("p-actions",i.fornecedorListaAcoes)("p-sort",!0)("p-striped",!0)("p-loading",i.carregandoTabelaFornecedor)("p-loading-show-more",i.carregandoDadosFornecedor)("p-show-more-disabled",i.desabilitarCarregarMais)("p-items",i.listaFornecedors)("p-columns",i.colunasTabelaFornecedor)("p-actions-right",!0))},dependencies:[h.O5,n.PJf,n.Ulp,n._w3,n.q5v],encapsulation:2})}return s})()}];let y=(()=>{class s{static#e=this.\u0275fac=function(r){return new(r||s)};static#o=this.\u0275mod=e.oAB({type:s});static#r=this.\u0275inj=e.cJS({imports:[d.Bz.forChild(A),d.Bz]})}return s})(),I=(()=>{class s{static#e=this.\u0275fac=function(r){return new(r||s)};static#o=this.\u0275mod=e.oAB({type:s});static#r=this.\u0275inj=e.cJS({imports:[h.ez,n.JBz,m.UX,y]})}return s})()}}]);