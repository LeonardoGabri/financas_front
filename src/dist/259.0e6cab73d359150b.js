"use strict";(self.webpackChunkfront_financas=self.webpackChunkfront_financas||[]).push([[259],{2259:(R,d,r)=>{r.r(d),r.d(d,{ParcelaFormModule:()=>S});var f=r(6895),l=r(8654),c=r(433),p=r(4229),m=r(1117),h=r(1147),u=r(4607),e=r(4650),v=r(1481),b=r(8095),g=r(2424);const P=[{path:"",component:(()=>{class t{constructor(a,i,o,s,n,Z,C,I){this.formBuilder=a,this.route=i,this.router=o,this.poDialogService=s,this.poNotification=n,this.titleService=Z,this.parcelaApiService=C,this.responsavelComboService=I,this.nomePrincipal=m.x8.label,this.somenteLeitura=!1,this.navegacao={items:[{label:this.nomePrincipal,action:this.verificarFormulario.bind(this)}]},this.acoes=[{action:()=>{this.salvar()},disabled:!1,label:"Salvar"},{action:()=>{this.cancelar()},disabled:!1,label:"Cancelar"}]}ngOnInit(){this.criarFormulario(),this.route.params.subscribe(a=>{a&&a.id?(this.nomePagina=(0,u.EI)(a.id).label,this.parcelaApiService.buscarParcelaPorId(a.id).subscribe({next:i=>{i&&(this.nomePagina=(0,u.EI)(a.id).label,this.somenteLeitura=!0,this.formulario.patchValue(i))},error:({error:i})=>{this.poNotification.error(i?.title?i.title:"Erro no servidor"),console.error(i)},complete:()=>{this.navegacao.items.push({label:this.nomePagina}),this.titleService.setTitle(`${this.nomePagina} - Motor Fiscal`)}})):(this.nomePagina=u.v.label,this.navegacao.items.push({label:this.nomePagina}),this.titleService.setTitle(`${this.nomePagina} - Motor Fiscal`))})}criarFormulario(a){this.formulario=this.formBuilder.group({id:[a?.id],mesReferencia:[a?.mesReferencia],anoReferencia:[a?.anoReferencia],compraId:[a?.compraId],responsavelId:[a?.responsavelId],valorParcelado:[a?.valorParcelado],parcelaAtual:[a?.parcelaAtual]})}salvar(){if(this.formulario.markAsPristine(),this.formulario.valid){let a=this.formulario.getRawValue(),i=a.id;delete a.id;let o=i?this.parcelaApiService.editarParcela(i,a):this.parcelaApiService.salvarParcela(a);this.acoes[0].disabled=!0,o.subscribe({next:s=>{s&&(this.poNotification.success("Salvo com sucesso"),this.router.navigate([m.x8.link]))},error:({error:s})=>{let n={message:s?.title?s.title:"Erro no servidor",action:()=>{},actionLabel:""};s?.detail&&(n.action=()=>{this.poDialogService.alert({title:s?.title,message:s?.detail,ok:()=>!0})},n.actionLabel="Detalhes"),this.poNotification.error(n),console.error(s)},complete:()=>{this.acoes[0].disabled=!1}})}else(0,h.DD)(this.formulario),this.poNotification.error("Erro no formul\xe1rio"),this.acoes[0].disabled=!1}cancelar(){this.verificarFormulario()}verificarFormulario(a,i=[m.x8.link],o=this.formulario){(0,h.TR)(i,o,this.router,this.poDialogService)}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(c.qu),e.Y36(p.gz),e.Y36(p.F0),e.Y36(l.Aw7),e.Y36(l.fRI),e.Y36(v.Dx),e.Y36(b.C),e.Y36(g.G))};static#a=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-parcela-form"]],decls:16,vars:6,consts:[[3,"p-title","p-breadcrumb","p-actions"],[3,"formGroup"],[1,"po-row"],["p-label","M\xeas de refer\xeancia","formControlName","mesReferencia","p-required","true","p-clean","true","p-mask","99",1,"po-md-6"],["p-label","Ano de refer\xeancia","formControlName","anoReferencia","p-required","true","p-clean","true","p-mask","2099",1,"po-md-6"],["formControlName","responsavelId","p-label","Respons\xe1vel",1,"po-md-6",3,"p-disabled","p-filter-service"],["p-label","Parcela Atual","formControlName","parcelaAtual","p-required","true","p-clean","true",1,"po-md-6"],["p-label","Valor parcelado","formControlName","valorParcelado","p-required","true","p-clean","true",1,"po-md-6"],["p-label","Visualizar Compra",1,"po-md-3",2,"margin-top","10px"]],template:function(i,o){1&i&&(e.TgZ(0,"po-page-default",0)(1,"po-container")(2,"form",1)(3,"div",2),e._UZ(4,"po-input",3)(5,"po-input",4),e.qZA(),e.TgZ(6,"div",2),e._UZ(7,"po-combo",5),e.qZA(),e.TgZ(8,"div",2),e._UZ(9,"po-input",6)(10,"po-decimal",7),e.qZA(),e.TgZ(11,"div",2),e._UZ(12,"po-button",8),e.qZA()(),e._UZ(13,"br")(14,"br")(15,"br"),e.qZA()()),2&i&&(e.Q6J("p-title",o.nomePagina)("p-breadcrumb",o.navegacao)("p-actions",o.acoes),e.xp6(2),e.Q6J("formGroup",o.formulario),e.xp6(5),e.Q6J("p-disabled",!0)("p-filter-service",o.responsavelComboService))},dependencies:[l.bOz,l.PJf,l.ZZR,l.dZS,l.xxV,l.MUI,c._Y,c.JJ,c.JL,c.sg,c.u],encapsulation:2})}return t})()}];let A=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#a=this.\u0275mod=e.oAB({type:t});static#i=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(P),p.Bz]})}return t})(),S=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#a=this.\u0275mod=e.oAB({type:t});static#i=this.\u0275inj=e.cJS({imports:[f.ez,l.JBz,c.UX,c.u5,A]})}return t})()}}]);